{% extends "base.html" %}
{% block title %}ìš´ì˜ì ëŒ€ì‹œë³´ë“œ - ë™ë„¤ë§í¬{% endblock %}

{% block extra_head %}
<style>
  .summary {
    display: flex;
    gap: 16px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }

  .summary-card {
    flex: 1;
    min-width: 180px;
    background: white;
    border-radius: 12px;
    padding: 14px 16px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.06);
  }

  .summary-card .label {
    font-size: 13px;
    color: var(--text-sub);
  }

  .summary-card .value {
    margin-top: 6px;
    font-size: 20px;
    font-weight: 700;
    color: var(--green-dark);
  }

  h2 {
    font-size: 17px;
    margin: 26px 0 10px;
    color: var(--green-dark);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 3px 10px rgba(0,0,0,0.06);
    font-size: 13px;
  }

  th, td {
    padding: 8px 10px;
    border-bottom: 1px solid var(--border);
    text-align: left;
  }

  th {
    background: #F0FFF4;
    color: var(--green-dark);
    font-weight: 600;
  }

  tr:last-child td { border-bottom: none; }

  .empty {
    padding: 12px;
    font-size: 13px;
    color: var(--text-sub);
  }

  .pending-link {
    font-size: 13px;
    color: var(--green-dark);
    margin-bottom: 8px;
  }
</style>
{% endblock %}

{% block content %}
<h1 style="font-size:22px; margin-top:0; color:var(--green-dark);">
  ìš´ì˜ì ëŒ€ì‹œë³´ë“œ
</h1>

<div class="summary">
  <div class="summary-card">
    <div class="label">ê°€ì… íšŒì› ìˆ˜</div>
    <div class="value">{{ users|length }}</div>
  </div>
  <div class="summary-card">
    <div class="label">ë“±ë¡ëœ ì—…ì²´ ìˆ˜</div>
    <div class="value">{{ businesses|length }}</div>
  </div>
  <div class="summary-card">
    <div class="label">ë™ë„¤ìƒí™œ ê¸€ ìˆ˜</div>
    <div class="value">{{ news_posts|length }}</div>
  </div>
  <div class="summary-card">
    <div class="label">ì‘ì„±ëœ ë¦¬ë·° ìˆ˜</div>
    <div class="value">{{ reviews|length }}</div>
  </div>
</div>

<div class="pending-link">
  ğŸ‘‰ <a href="/admin/businesses/pending" style="color:var(--green-dark); font-weight:600;">
    ìŠ¹ì¸ ëŒ€ê¸° ì—…ì²´ ë³´ëŸ¬ê°€ê¸°
  </a>
</div>

<h2>íšŒì› ëª©ë¡</h2>
{% if users %}
<table>
  <thead>
    <tr>
      <th>ì•„ì´ë””</th>
    </tr>
  </thead>
  <tbody>
    {% for u in users %}
    <tr><td>{{ u.username if u.username is defined else u["username"] }}</td></tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div class="empty">ê°€ì…í•œ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</div>
{% endif %}

<h2>ë“±ë¡ëœ ì—…ì²´</h2>
{% if businesses %}
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>ì¢…ë¥˜</th>
      <th>ì—…ì²´ëª…</th>
      <th>ì¹´í…Œê³ ë¦¬</th>
      <th>ì§€ì—­</th>
      <th>ë“±ë¡ì</th>
      <th>ìŠ¹ì¸</th>
      <th>ê²°ì œ</th>
    </tr>
  </thead>
  <tbody>
    {% for b in businesses %}
    <tr>
      <td>{{ b.id if b.id is defined else b["id"] }}</td>
      <td>{{ "ë§›ì§‘" if (b.kind if b.kind is defined else b["kind"]) == "food" else "ìˆ˜ë¦¬" }}</td>
      <td>{{ b.name if b.name is defined else b["name"] }}</td>
      <td>{{ b.category if b.category is defined else b["category"] }}</td>
      <td>
        {{ b.sido if b.sido is defined else b["sido"] }}
        {{ b.sigungu if b.sigungu is defined else b["sigungu"] }}
        {{ b.dong if b.dong is defined else b["dong"] }}
      </td>
      <td>{{ b.owner if b.owner is defined else b["owner"] }}</td>
      <td>{{ "ìŠ¹ì¸" if (b.approved if b.approved is defined else b["approved"]) else "ëŒ€ê¸°" }}</td>
      <td>{{ "ê²°ì œì™„ë£Œ" if (b.paid if b.paid is defined else b["paid"]) else "-" }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div class="empty">ë“±ë¡ëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
{% endif %}

<h2>ë¦¬ë·°</h2>
{% if reviews %}
<table>
  <thead>
    <tr>
      <th>ì—…ì²´ ID</th>
      <th>ì‘ì„±ì</th>
      <th>í‰ì </th>
      <th>ë‚´ìš©</th>
    </tr>
  </thead>
  <tbody>
    {% for r in reviews %}
    <tr>
      <td>{{ r.business_id if r.business_id is defined else r["business_id"] }}</td>
      <td>{{ r.username if r.username is defined else r["username"] }}</td>
      <td>{{ r.rating if r.rating is defined else r["rating"] }}</td>
      <td>{{ r.comment if r.comment is defined else r["comment"] }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div class="empty">ì‘ì„±ëœ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
{% endif %}
{% endblock %}
